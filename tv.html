<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>TV - Painel</title>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: sans-serif;
      display: flex;
      flex-direction: row;
      height: 100vh;
    }
    iframe {
      width: 50%;
      height: 100%;
      border: none;
    }
    .painel {
      width: 50%;
      padding: 2em;
      box-sizing: border-box;
    }
    .atual {
      font-size: 2em;
      margin-bottom: 2em;
    }
    .lista {
      font-size: 1.2em;
      text-align: left;
    }
  </style>
</head>
<body>
  <iframe src="https://www.youtube.com/embed/OPtRHSv2huE?autoplay=1&mute=1&loop=1&playlist=OPtRHSv2huE"></iframe>
  <div class="painel">
    <div class="atual" id="chamadoAtual">Aguardando chamada...</div>
    <div class="lista" id="ultimos"></div>
  </div>

  <script type="module">
    import { db } from './firebase-config.js';
    import {
      ref, onValue
    } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-database.js";

    const atual = document.getElementById('chamadoAtual');
    const ultimos = document.getElementById('ultimos');

    onValue(ref(db, 'chamadoAtual'), snap => {
      const dados = snap.val();
      if (dados) {
        atual.innerHTML = `<strong>${dados.nome}</strong><br><em>${dados.profissional}</em><br>${dados.hora}`;
      } else {
        atual.textContent = "Aguardando chamada...";
      }
    });

    onValue(ref(db, 'ultimasChamadas'), snap => {
      const lista = snap.val() || [];
      ultimos.innerHTML = "<h3>Ãšltimas Chamadas:</h3>" + lista.reverse().map(c =>
        `<p><strong>${c.nome}</strong> - ${c.profissional} <br><small>${c.hora}</small></p>`
      ).join('');
    });
  </script>
</body>
</html>
